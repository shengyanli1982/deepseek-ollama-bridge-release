**书接上回：** https://linux.do/t/topic/447970

很高兴向大家宣布 DeepSeek-Ollama Bridge v0.1.16-rc1 正式发布！经过紧锣密鼓的开发和全面测试，这个版本已经准备好为你带来全新体验。

**核心功能亮点：**

-   **请求拦截与修改**：提供对所有进入 DeepSeek-Ollama Bridge 请求的智能拦截和灵活修改能力，为你的应用提供基础安全防护。
-   **内容安全过滤**：通过强大的 Lua 脚本，你可以对模型的输入和输出内容进行精准过滤和屏蔽，有效防止违规内容的产生和传播。

**Lua 脚本模板示例：**

```lua
-- 处理请求
-- @param request table 请求对象
--   - request.path string 请求路径 (例如: "/api/users")
--   - request.method string 请求方法 (例如: "GET", "POST")
--   - request.headers table 请求头
--     - 键为小写的header名称 (例如: "content-type", "authorization")
--     - 值为对应的header值
--   - request.body string 请求体内容
-- @return boolean, table 返回两个值:
--   1. boolean:
--      - true: 继续处理请求
--      - false: 拦截请求，返回自定义响应
--   2. table:
--      当第一个返回值为 true 时:
--        - 返回修改后的 request 表
--      当第一个返回值为 false 时:
--        - status_code number HTTP状态码
--        - body string 响应体
--        - headers table 响应头
function HandleServerRequest(request)

    -- 示例：记录请求
    print("Handling request to: " .. request.path)

    -- 示例：修改请求头
    request.headers["x-modified-by"] = "Lua-Middleware-Request"

    -- 示例：拦截特定请求
    if request.path == "/blocked" then
        return false, {
            status_code = 403,
            body = "Access denied by Lua middleware",
            headers = {
                ["content-type"] = "text/plain"
            }
        }
    end

    -- 继续处理请求
    return true, request
end

-- 处理响应
-- @param response table 响应对象
--   - response.status_code number HTTP状态码 (例如: 200, 404)
--   - response.headers table 响应头
--     - 键为小写的header名称 (例如: "content-type")
--     - 值为对应的header值
--   - response.body string 响应体内容
-- @return table 返回修改后的响应对象
--   - status_code number 修改后的HTTP状态码
--   - headers table 修改后的响应头
--   - body string 修改后的响应体内容
function HandleServerResponse(response)

    -- 示例：添加响应头
    response.headers["x-powered-by"] = "Lua-Middleware-Response"

    -- 调试日志：打印Content-Type
    print("Response Content-Type:", response.headers["content-type"])

    -- 示例：修改响应体
    if response.headers["content-type"] == "text/plain" then
        response.body = response.body .. "\n(Modified by Lua)"
    end

    -- 返回修改后的响应对象
    return response
end
```

**运行效果图示：**

![运行效果图示](./images/1.png)

**本次版本更新亮点：**

-   **0.1.16-rc1 版本**：
    -   集成高性能 LuaJIT 运行时，支持复杂脚本逻辑的高效执行
    -   新增 LuaJIT 相关 Prometheus 指标监控，让你的脚本运行状态一目了然

**未来规划：**

我们决定放弃原先的 WebAssembly 扩展方案，因为其复杂的接口和各类开发 SDK 的对接工作无形中增加了开发者的学习成本和项目的维护难度。**在 0.1.16-rc2 及后续版本中**，我们将全力专注于第三方 Lua 模块的支持，引入类似 OpenResty 的 `lua_package_path` 和 `lua_package_cpath` 配置机制。这一改进将让你能够像在 OpenResty 环境中一样，通过简单的 `require` 语句轻松加载丰富的 Lua 模块生态，从而大幅提升开发效率和功能扩展性，让定制化开发变得更加简单直观。

**部署方式升级：**

为满足不同用户的需求，除了传统的 Windows、Linux、MacOS 二进制安装包外，我们现已提供便捷的 Docker 镜像支持。你可以直接从 [ghcr.io](http://ghcr.io/) 镜像仓库获取最新版本（详细地址请查看 release notes）。

**反馈与支持：**

我们非常重视你的使用体验！如果你在使用过程中遇到任何问题或有改进建议，请随时在评论区留言。我们的团队将第一时间跟进并解决你的问题，共同打造更好的 DeepSeek-Ollama Bridge。
